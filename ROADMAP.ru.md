dart_swagger_to_models — Дорожная карта
=======================================

Ниже — план развития проекта на русском. Оригинальный английский вариант — в `ROADMAP.md`.

## v0.2 — Усиление ядра и улучшение DX

### 0.2.1 Улучшенная поддержка OpenAPI
- Нормализовать поддержку `oneOf` / `anyOf`:
  - Пока что — более безопасные `dynamic`-обёртки и понятные сообщения в логах.
  - Подготовить архитектуру под будущую генерацию union‑типов (особенно с `discriminator`).
- Расширить поддержку `allOf`:
  - Корректно обрабатывать вложенные комбинации `allOf` и случаи множественного наследования.
  - Добавить тесты на сложные составные схемы.

### 0.2.2 Конфигурационный файл генератора
- Добавить поддержку файла `dart_swagger_to_models.yaml` в корне проекта:
  - Глобальные опции: `defaultStyle`, `outputDir`, `projectDir`.
  - Переопределения для отдельных схем: кастомный `className`, имена полей, маппинг типов.
- Добавить CLI‑опцию `--config` для указания пути к конфигу.
- Тесты:
  - Проверить приоритет: CLI > config > значения по умолчанию.

### 0.2.3 Качество генерируемого кода
- Запускать `dart format` для всех сгенерированных файлов (через флаг `--format`).
- Улучшения для enum’ов:
  - Поддержать `x-enumNames` / `x-enum-varnames`, если они есть в спецификации.
  - При отсутствии — сохранять текущее поведение.
- Гарантировать корректные импорты между моделями вместо `dynamic`, если для схемы есть реальный Dart‑тип.

## v0.3 — Расширяемость и стили

### 0.3.1 Подключаемые стили (pluggable styles)
- Публичный API для регистрации пользовательских стилей генерации:
  - Внешний пакет может предоставить свою реализацию `ClassGeneratorStrategy`.
  - Привязка имени стиля к стратегии через конфиг или расширяемую точку.
- Пример кастомного стиля:
  - Например, поддержка `equatable`, дополнительные `copyWith` и т.п.
- Документация:
  - Раздел “How to create your own generation style” с пошаговым гайдом.

### 0.3.2 Улучшение ergonomics для json_serializable / freezed
- Опциональная генерация `@JsonKey(name: '...')` для snake_case JSON‑ключей.
- Опции в конфиге:
  - `useJsonKey: true/false` (глобально и на уровне отдельной схемы).
- Обновить документацию и тесты, покрывающие поведение `JsonKey` и для `json_serializable`, и для `freezed`.

## v0.4 — Интеграция с экосистемой

### 0.4.1 Интеграция с build_runner
- Реализовать `Builder`, который:
  - читает спецификацию Swagger/OpenAPI и конфиг,
  - генерирует модели как часть пайплайна `build_runner`.
- Добавить проект в `example/`:
  - пример на чистом Dart,
  - пример на Flutter, где сгенерированные модели используются вместе с HTTP‑клиентом.
- Задокументировать интеграцию с `build_runner` в `docs/en/USAGE.md` и `docs/ru/USAGE.md`.

### 0.4.2 Улучшенный DX и логирование
- CLI‑флаги:
  - `--verbose` для подробных логов,
  - `--quiet` для минимального вывода.
- Человекочитаемые сообщения об ошибках:
  - отсутствующие цели для `$ref`,
  - неподдерживаемые или неоднозначные конструкции схем,
  - предупреждения о “подозрительных” спецификациях (например, `id` без `nullable: true`, но и без `required`).
- Сводка после генерации:
  - количество обработанных схем, enum’ов, созданных/обновлённых файлов.

## v0.5 — Инкрементальная генерация и lint спецификаций

### 0.5.1 Инкрементальная генерация
- Кэшировать последнюю обработанную спецификацию (хеши по схемам) в `.dart_swagger_to_models.cache`.
- Опция `--changed-only`:
  - перегенерировать только те модели, чьи схемы действительно изменились.
- Тесты:
  - добавление новой схемы,
  - удаление схемы,
  - изменение только одной схемы в большой спецификации.

### 0.5.2 Подсказки по качеству спецификаций (spec linting)
- Опциональный слой “lint” для спецификаций:
  - предупреждать о полях без `type`,
  - предупреждать о явно неконсистентных конструкциях (конфигурируемо).
- Конфигурируемые правила в `dart_swagger_to_models.yaml`:
  - включать/выключать отдельные lint‑правила,
  - настраивать уровень серьёзности (warning vs error).

## v0.6 — Продвинутые возможности OpenAPI

### 0.6.1 Union типы для oneOf/anyOf
- Генерировать полноценные union типы вместо `dynamic`-обёрток:
  - Поддержка свойства `discriminator` для различения типов
  - Генерация sealed классов или freezed unions
  - Type-safe pattern matching для union типов
- Конфигурация:
  - Опция выбора реализации union типов (sealed classes vs freezed unions)
  - Поддержка кастомных маппингов discriminator
- Тесты:
  - Сложные сценарии oneOf/anyOf с discriminator
  - Вложенные union типы
  - Union типы в комбинации с allOf

### 0.6.2 Генерация валидации схем
- Генерировать код валидации на основе ограничений Swagger:
  - `min`/`max` для чисел и строк
  - `pattern` для валидации строк (RegExp)
  - `format` валидация (email, uri, date-time и т.д.)
  - `minLength`/`maxLength` для строк и массивов
  - `minItems`/`maxItems` для массивов
- Варианты интеграции:
  - Генерация методов валидации в моделях
  - Поддержка пакетов валидации (dart_validators, reactive_forms)
  - Опциональные аннотации валидации
- Конфигурация:
  - Включить/выключить генерацию валидации
  - Выбор подхода к валидации (методы vs аннотации)

### 0.6.3 Генерация документации
- Генерировать DartDoc комментарии из описаний Swagger:
  - Документация уровня класса из `description` схемы
  - Документация уровня поля из `description` свойства
  - Сохранение примеров из Swagger как комментариев к коду
  - Поддержка markdown в описаниях
- Конфигурация:
  - Включить/выключить генерацию документации
  - Настройка формата документации

## v0.7 — Улучшения DX

### 0.7.1 Watch режим
- Флаг `--watch` для автоматической регенерации:
  - Мониторинг файла спецификации на изменения
  - Автоматическая регенерация моделей при сохранении файла
  - Поддержка нескольких файлов спецификаций
  - Настраиваемая задержка debounce
- Возможности:
  - Показ diff перед регенерацией
  - Опция подтверждения перед перезаписью файлов
  - Интеграция с file watchers IDE

### 0.7.2 Генерация тестовых данных
- Генерировать тестовые фабрики для моделей:
  - Создание отдельных файлов с тестовыми фабриками (например, `test/models/factories/`)
  - Использование примеров из Swagger для реалистичных тестовых данных
  - Генерация валидных/невалидных вариантов для тестирования
  - Поддержка библиотек faker (faker_dart)
- Конфигурация:
  - Выходная директория для тестовых фабрик
  - Настройка стиля генерации фабрик
  - Включить/исключить конкретные схемы

### 0.7.3 Интерактивный режим
- Интерактивный режим CLI для выборочной генерации:
  - Меню для выбора схем для генерации
  - Предпросмотр изменений перед генерацией
  - Запросы подтверждения для перезаписи файлов
  - Показ diff для существующих файлов
- Возможности:
  - Фильтрация схем по паттерну имени
  - Пакетные операции (выбрать все, снять выбор)
  - Сохранение/загрузка пресетов выбора

## v0.8 — Производительность и масштабируемость

### 0.8.1 Параллельная генерация
- Генерация нескольких моделей параллельно:
  - Использование нескольких ядер CPU для ускорения генерации
  - Параллельная обработка независимых схем
  - Отслеживание прогресса параллельных операций
- Конфигурация:
  - Количество параллельных воркеров
  - Оптимизация использования памяти

### 0.8.2 Оптимизация для больших спецификаций
- Оптимизации для больших спецификаций (1000+ схем):
  - Потоковый парсинг JSON/YAML
  - Инкрементальная обработка схем
  - Эффективное по памяти разрешение зависимостей
  - Индикаторы прогресса для длительных операций

### 0.8.3 Улучшения кэширования
- Улучшенная система кэширования:
  - Кэширование распарсенных спецификаций
  - Кэширование разрешённых $ref ссылок
  - Кэширование шаблонов сгенерированного кода
  - Стратегии инвалидации кэша

## v0.9 — Экосистема и интеграции

### 0.9.1 Интеграции с state management
- Генерация кода для популярных решений state management:
  - Riverpod providers для моделей
  - BLoC events и states
  - Provider factories
- Конфигурация:
  - Выбор библиотеки state management
  - Настройка паттернов генерации

### 0.9.2 Генерация API клиента (экспериментально)
- Генерация HTTP клиентского кода из OpenAPI paths:
  - REST API клиентские методы
  - Типобезопасность запросов/ответов
  - Обработка ошибок
  - Поддержка популярных HTTP клиентов (dio, http, chopper)
- Конфигурация:
  - Выбор библиотеки HTTP клиента
  - Настройка стиля генерации клиента
  - Конфигурация базового URL

### 0.9.3 Интеграция с CI/CD
- Шаблоны workflow для GitHub Actions
- Примеры конфигурации GitLab CI
- Pre-commit хуки для валидации моделей
- Автоматическая генерация моделей в CI пайплайнах

## v0.10 — Продвинутые возможности

### 0.10.1 Кастомные шаблоны кода
- Поддержка кастомных шаблонов кода:
  - Template engine для генерации моделей
  - Пользовательские шаблоны на стиль
  - Наследование и композиция шаблонов
- Конфигурация:
  - Директория шаблонов
  - Выбор шаблона на схему

### 0.10.2 Поддержка многофайловых спецификаций
- Поддержка нескольких файлов спецификаций:
  - Объединение нескольких файлов OpenAPI/Swagger
  - Разрешение $ref ссылок между файлами
  - Генерация моделей из нескольких источников
- Конфигурация:
  - Список файлов спецификаций
  - Стратегия объединения

### 0.10.3 Хуки генерации кода
- Pre/post хуки генерации:
  - Кастомные скрипты до/после генерации
  - Трансформация сгенерированного кода
  - Кастомная валидация
- Конфигурация:
  - Конфигурация скриптов хуков
  - Порядок выполнения хуков

---

## Выполненные версии

✅ **v0.2** — Усиление ядра и улучшение DX (все задачи выполнены)
✅ **v0.3** — Расширяемость и стили (все задачи выполнены)
✅ **v0.4** — Интеграция с экосистемой (все задачи выполнены)
✅ **v0.5** — Инкрементальная генерация и lint спецификаций (все задачи выполнены)

---

## Рекомендации по следующим шагам

Рекомендуемые отправные точки для v0.6+:

1. **v0.6.1 (Union типы)** — Высокая ценность, строится на существующей архитектуре oneOf/anyOf
2. **v0.7.1 (Watch режим)** — Отличное улучшение DX, относительно просто реализовать
3. **v0.6.3 (Генерация документации)** — Быстрая победа, улучшает качество кода

Эти задачи относительно изолированы и могут быть разбиты на отдельные GitHub Issues / PR.

